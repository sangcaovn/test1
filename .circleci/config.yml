version: 2.1

jobs: 
  build-step:
    working_directory: ~/repo
    steps:
      - attach_workspace:
          at: ~/repo
      - checkout
      - run:
          name: Clone smart contract from thought machine content
          command:  >-
            GIT_SSH_COMMAND='ssh -i ~/.ssh/id_rsa_fingerprint'
            git clone https://github.com/PrjPhx/thought-machine-content.git ~/repo


workflows:
  version: 2
  build_and_push:
    jobs:
      - test:
          context: build-test-push
      - push-deploy:
          context:  build-test-push
          requires:
            - test
          filters:
            branchs:
              only: master